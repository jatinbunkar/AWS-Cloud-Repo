# Create EBS & Snapshot through CLI

1. **Create an EC2 Linux Instance.**

   Attach the **SSM Role** and apply the **Describe Volume Policy**:

   ```yaml
   {
     "Version": "2012-10-17",
     "Statement": [
         {
             "Effect": "Allow",
             "Action": "ec2:DescribeVolumes",
             "Resource": "*"
         }
     ]
   }


<img width="1175" alt="image" src="https://github.com/user-attachments/assets/34e5d9e2-e9a5-4a7c-8e76-96ea35dac0f4">


2. **Connect to the EC2 Instance.**

   - **Switch to the root user:**
     ```bash
     sudo su -
     ```

   - **Connect to AWS:**
     ```bash
     aws configure
     ```
     Provide the access key, and secret key, and specify the default region (availability zone).

3. **Find the Volume ID attached to the instance:**
   ```bash
   aws ec2 describe-volumes --filters Name=attachment.instance-id,Values=i-0978ee5807131a27d
   ```


   <img width="834" alt="image" src="https://github.com/user-attachments/assets/35c11d1b-3729-4759-a6e4-e731f73a3ed0">

vol-0428c1afb436a7653


4. **To create a snapshot for the existing attached EBS volume.**

```bash
aws ec2 create-snapshot --volume-id vol-0428c1afb436a7653 --description "This is my root volume snapshot created from CLI"
```

<img width="1056" alt="image" src="https://github.com/user-attachments/assets/62b91b12-24dc-43b8-8a3f-0c92199f8bb0">



<img width="1205" alt="image" src="https://github.com/user-attachments/assets/ed67e18a-c6dd-462b-9e67-2ed874917123">

snap-0cba0bdc1c7f08e26

5. Note the snapshot ID created, now letâ€™s Create Volume and enter the snapshot ID of the snapshot
created in the above step and enter the volume size greater than the default one attached to our
instance. Note that the volume is created and the snapshot should be in the same availability zone.

```bash
aws ec2 create-volume --volume-type gp2 --size 10 --snapshot-id snap-0cba0bdc1c7f08e26 --availability-zone us-east-1a
```
<img width="1016" alt="image" src="https://github.com/user-attachments/assets/205fae6e-6ea7-474d-8b15-b910f0bde4fc">

A New Volume was Created with the new size.

vol-0485895fbeeffee6

6. Now, stop the state of the EC2 instance from the console, Because we cannot detach the default volume attached to our EC2 instance when the instance is running.

7. Since the instance is stopped we will perform further actions from the console. Go to the default volume attached to your ec2 instance, select it, choose Actions, and then choose Detach.

<img width="1168" alt="image" src="https://github.com/user-attachments/assets/6ac509c9-a87c-4554-b682-6224c6ad966b">

<img width="1191" alt="image" src="https://github.com/user-attachments/assets/69d678b7-13bc-401e-9353-addfc985d730">

<img width="1179" alt="image" src="https://github.com/user-attachments/assets/5c4bdc2d-4d02-44bb-9386-0f477cd979d1">

**Default EBS Volume detached from the instance.** 

8. Now select the new EBS volume created, choose Actions, and then choose Attach by providing the instance id and device name as /dev/xvda.

<img width="661" alt="image" src="https://github.com/user-attachments/assets/47bde228-53fd-4d3a-807d-5be1168bf4cd">

<img width="1177" alt="image" src="https://github.com/user-attachments/assets/e7e4c946-aee9-4e72-aed5-83d1bd71e434">


### Now we have our new EBS volume with a greater size attached to the EC2 instance.


**Supporting Reference:**

- [AWS Documentation: Creating an EBS Volume](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ebs-creating-volume.html)
- [AWS CLI Reference: EC2](https://docs.aws.amazon.com/cli/latest/reference/ec2/index.html)











