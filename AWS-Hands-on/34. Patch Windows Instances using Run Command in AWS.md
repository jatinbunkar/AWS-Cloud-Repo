# **Patch Windows Instances using Run Command in AWS**

## **Description**


In this hands-on lab, you will solve a real-world scenario where we will patch our Windows servers using the **Run Command** feature in AWS Systems Manager Service.  
**Run Command** enables you to automate common administrative tasks and perform ad hoc configuration changes at scale.

---

## **Architecture Diagram**
The diagram below displays a visual representation of the application architecture:

<img width="758" alt="image" src="https://github.com/user-attachments/assets/228f8bc2-da70-47a5-b11d-e324a1e23212">

## **Lab Steps**

Follow the steps outlined below to achieve the objective of this lab exercise.

### **Step 1: Launch a Windows EC2 Instance**
1. Log in to the AWS Console and navigate to the **EC2** service.
2. In the EC2 dashboard, click on **Launch Instance**.
3. In **Step 1: Choose an Amazon Machine Image (AMI)**, select **Microsoft Windows Server 2019 Base**.
4. In **Step 2: Choose Instance Type**, select **t2.micro**, and click **Next**.
5. In **Step 3: Configure Instance Details**, under **IAM Role**, choose **EC2-Role**, and click **Review and Launch**.
6. (Optional) Create a key pair if you plan to RDP into your instance via a Remote Desktop client. If you prefer using the **Session Manager** service, choose the option **Proceed without a key pair**.

### **Step 2: Ensure the Instance is Running**
7. In the **Instances Dashboard**, confirm that your instance is in a **running** state.

<img width="916" alt="image" src="https://github.com/user-attachments/assets/37e5cb61-a9a6-41ce-a765-3701c4b5531e">

### **Step 3: Create an S3 Bucket**
8. Navigate to the **S3** service.
9. Create a new bucket, ensuring that it adheres to the S3 bucket naming rules.

<img width="979" alt="image" src="https://github.com/user-attachments/assets/1824dcc8-1596-48e7-baf3-46e9aeef3fb3">

### **Step 4: Use Systems Manager Run Command**
10. Navigate to the **Systems Manager** service.
11. In the left-hand pane, under **Instances and Nodes**, select **Run Command**.
12. Click on **Run Command** and search for the document **AWS-RunPatchBaseline**, then select it.

<img width="1159" alt="image" src="https://github.com/user-attachments/assets/72aef0ab-99b8-490b-81d4-40e55ec26f7f">

### **Step 5: Configure Command Parameters**
13. Scroll down to the **Command Parameters** section and set the **Operation** to **Install**.

<img width="940" alt="image" src="https://github.com/user-attachments/assets/e77a000d-859f-4ae1-be2c-e886a2c2c3b6">

### **Step 6: Select Targets**
14. Under the **Targets** section, choose how to select instances:
    - For this lab, select **Choose instances manually** and select the instance you created earlier.
    - In real-world scenarios, you may have a greater number of instances categorized under tags (e.g., dev, prod) or resource groups. Use those options for more efficient targeting.

<img width="1153" alt="image" src="https://github.com/user-attachments/assets/243fe56e-3462-46ee-bb0d-10cbb6ad82d2">

### **Step 7: Enable Output Logging**
15. Under **Output Options**, check the option **Enable writing to an S3 Bucket**, then select the S3 bucket you created in Step 3.

<img width="1153" alt="image" src="https://github.com/user-attachments/assets/31d760ae-64b2-4ff7-9656-7f55cbeebe7e">

### **Step 8: Run the Command**
16. Click **Run** to execute the command.  
    - Monitor the command status until it changes to **Success**.

### **Step 9: Verify the Results**
17. Once the status shows **Success**, your server has been patched successfully.
18. Navigate to the S3 bucket you created earlier to view the log file for details of the operation.

