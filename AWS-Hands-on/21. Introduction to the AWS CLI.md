
# Introduction to the AWS CLI

### Description:

In this lab exercise, we will create a Lightsail instance using CLI. Once the instance got created, we will connect to
the instance and also access the application that is hosted in the instance via browser.

### Architecture Diagram:
The diagram below displays a visual representation of the application architecture:

<p align="center">
  <img src="https://github.com/jatinbunkar/AWS-Clouds/blob/0a22cd068ace1a6760771de0e8b737ca65058fdd/Screenshots/lab21-s1.png" alt="Screenshot of lab21-s1">
</p>

<br>


### Steps
Follow the steps outlined below to achieve the objective of this lab exercise:
1. Navigate to the EC2 service in AWS console.
2. Create an Amazon Linux 2 instance with type as t2.micro and attach the CCL-EC2-Role.
3. Save the Key Pair and SSH into the instance using the key pair or the Session Manager.


4. Update the instance using the following command:

```
yum update -y
```


5. Create a launch script file with the following command:

```
Cat > launch.sh
```

6. Copy and paste the following script and press Ctrl+D.

```bash

# remove default website
#-----------------------
cd /opt/bitnami/apache2/htdocs
rm -rf *
# clone github repo
#------------------
git clone -b loft https://github.com/mikegcoleman/todo-php .
# set write permissons on the settings file
#-----------------------------------
chown bitnami:daemon connectvalues.php
chmod 666 connectvalues.php
# inject database password into configuration file
#-------------------------------------------------
sed -i.bak "s/<password>/$(cat
/home/bitnami/bitnami_application_password)/;"
/opt/bitnami/apache2/htdocs/connectvalues.php
# create database
#----------------
cat /home/bitnami/htdocs/data/init.sql |
/opt/bitnami/mysql/bin/mysql -u root -p$(cat
/home/bitnami/bitnami_application_password)

```
7. Note the file path of the launch.sh file.
8. Create a Lightsail instance using the following commands by replacing <INSTANCE NAME> AND <FILE PATH> that you noted previously.
```
aws lightsail create-instances --instance-names <INSTANCE NAME> --
availability-zone us-east-2a --blueprint-id lamp_7 --bundle-id
nano_2_0 --user-data <FILE PATH>
```
9. Navigate to the Lightsail service from AWS console and wait until the status of instance changes to
running.

10. Access the public IP in the browser and find the todo application.

11. Similarly using CLI you can perform much more actions.

### Supporting References
Refer the below links for additional information:
1. [AWS Documentation: AWS CLI](https://docs.aws.amazon.com/cli/latest/reference/)
2. [AWS Documentation: Create Instance](https://docs.aws.amazon.com/cli/latest/reference/opsworks/create-instance.html)


